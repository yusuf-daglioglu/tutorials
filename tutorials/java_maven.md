# JAVA MAVEN

IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII

IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII

## ğŸ“Œ Maven

## ğŸ“Œ super pom

her `pom.xml` bir `super pom` dosyasÄ±ndan tÃ¼rer. `super pom`'da default deÄŸerler yer alÄ±r. bu deÄŸerler, runtime sÄ±rasÄ±nda `pom.xml` dosyasÄ±nÄ± okuyan ve iÅŸleyecek olan program (`Eclipse` `Maven` eklentisi gibi) `super pom`'u oluÅŸturur. bu deÄŸerleri saklamakta yarar vardÄ±r. zira sonraki `Maven` sÃ¼rÃ¼mlerinde deÄŸiÅŸen deÄŸerler olabilir. `super pom` dosyasÄ±na bulanabilecek 

Ã¶rnek deÄŸerler:

- test classes directory
- source classes directory
- plugins

## ğŸ“Œ effective pom.xml

projemizdeki `pom.xml` ve `super pom` dosyasÄ±nÄ±n birleÅŸimidir. `pom.xml` dosyamÄ±zdaki her deÄŸer, `super pom` dosyamÄ±zdakileri override eder.

`effective pom.xml` dosyamÄ±zÄ± gÃ¶rmek istediÄŸimizde bir tool (Ã¶rnek `IDE`) bize `pom.xml` dosyamÄ±zdan `effective pom.xml` otomatik generate eder.

Ã¶rnek; source code dizininin nerede olduÄŸu, `pom.xml` iÃ§inde yazmaz. fakat `effective pom.xml` dosyasÄ±nda yazar. `effective pom.xml` tÃ¼m detaylarÄ± iÃ§erir. bu dosyayÄ± backup alÄ±p, source code iÃ§ine koymakta yarar olabilir.

`effective pom.xml` dosyasÄ±nÄ±, `pom.xml` dosyasÄ±na komple yapÄ±ÅŸtÄ±rsak hiÃ§bir ÅŸey deÄŸiÅŸmez. yine projemiz Ã§alÄ±ÅŸmaya devam eder.

`effective pom.xml` dosyasÄ±nÄ± komut satÄ±rÄ±ndan bu ÅŸekilde gÃ¶rebiliriz:

```sh
mvn help:effective-pom
```

## ğŸ“Œ Maven tanÄ±mlarÄ±

bÃ¼yÃ¼kten kÃ¼Ã§Ã¼ÄŸe:

- lifecycle
- build phase
- goal

`execution` tanÄ±mÄ± `goal` ile aynÄ± seviyede. `execution` aÅŸaÄŸÄ±da anlatÄ±lmaktadÄ±r.

## ğŸ“Œ lifecycle

- `clean`
- `default`
- `site`

her `lifecycle` iÃ§inde birÃ§ok `phase` vardÄ±r.

`clean` `lifecycle` `phases`:

| Phase      | Description                                                   |
|------------|---------------------------------------------------------------|
| pre-clean  | execute processes needed prior to the actual project cleaning |
| clean      | remove all files generated by the previous build              |
| post-clean | execute processes needed to finalize the project cleaning     |

default lifecycle phases:

| Phase                   | Description                                                                                                                                                                   |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| validate                | validate the project is correct and all necessary information is available.                                                                                                   |
| initialize              | initialize build state, e.g. set properties or create directories.                                                                                                            |
| generate-sources        | generate any source code for inclusion in compilation.                                                                                                                        |
| process-sources         | process the source code, for example to filter any values.                                                                                                                    |
| generate-resources      | generate resources for inclusion in the package.                                                                                                                              |
| process-resources       | copy and process the resources into the destination directory, ready for packaging.                                                                                           |
| compile                 | compile the source code of the project.                                                                                                                                       |
| process-classes         | post-process the generated files from compilation, for example to do `Bytecode` enhancement on Java classes.                                                                    |
| generate-test-sources   | generate any test source code for inclusion in compilation.                                                                                                                   |
| process-test-sources    | process the test source code, for example to filter any values.                                                                                                               |
| generate-test-resources | create resources for testing.                                                                                                                                                 |
| process-test-resources  | copy and process the resources into the test destination directory.                                                                                                           |
| test-compile            | compile the test source code into the test destination directory                                                                                                              |
| process-test-classes    | post-process the generated files from test compilation, for example to do `Bytecode` enhancement on Java classes. For Maven 2.0.5 and above.                                    |
| test                    | run tests using a suitable unit testing framework. These tests should not require the code be packaged or deployed.                                                           |
| prepare-package         | perform any operations necessary to prepare a package before the actual packaging. This often results in an unpacked, processed version of the package. (Maven 2.1 and above) |
| package                 | take the compiled code and package it in its distributable format, such as a JAR.                                                                                             |
| pre-integration-test    | perform actions required before integration tests are executed. This may involve things such as setting up the required environment.                                          |
| integration-test        | process and deploy the package if necessary into an environment where integration tests can be run.                                                                           |
| post-integration-test   | perform actions required after integration tests have been executed. This may including cleaning up the environment.                                                          |
| verify                  | run any checks to verify the package is valid and meets quality criteria.                                                                                                     |
| install                 | install the package into the local repository, for use as a dependency in other projects locally.                                                                             |
| deploy                  | done in an integration or release environment, copies the final package to the remote repository for sharing with other developers and projects.                              |

Site Lifecycle phases:

| Phase       | Description                                                                                  |
|-------------|----------------------------------------------------------------------------------------------|
| pre-site    | execute processes needed prior to the actual project site generation                         |
| site        | generate the project's site documentation                                                    |
| post-site   | execute processes needed to finalize the site generation, and to prepare for site deployment |
| site-deploy | deploy the generated site documentation to the specified web server                          |

## ğŸ“Œ Ã¶rnek komutlar

- `mvn clean deploy`

  `clean` `lifecycle`'Ä± ve ardÄ±ndan deploy `phase`'sini Ã§aÄŸrÄ±lÄ±r. deploy `phase`'ine gelene kadar ki tÃ¼m `phase`'leri Ã§aÄŸÄ±rÄ±r.

- `mvn Maven-compiler-plugin:2.5.1:compile`

  `Maven-compiler-plugin` plugin'inin `compile` `goal`'unu Ã§aÄŸÄ±rÄ±r. diÄŸer `lifecycle` iÃ§erisindeki `phase`'leri Ã§aÄŸÄ±rmaz.

  Burada 'compile' plugin'in bir goal'Ã¼dÃ¼r. herhangi bir isim alabilir. 1 plugin goal'Ã¼ istenirse, Maven'Ä±n default `phase`'lerinden herhangi birine bound edilebilir. bÃ¶ylece Maven'Ä±n o `phase`'Ä± Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda otomatik olarak Maven bound edilen goal'i de Ã§aÄŸÄ±rÄ±r.

  Hatta istenirse bir goal birden fazla Maven `phase`'Ä±na da bound edilebilir.

- mvn clean Maven-compiler-plugin:2.5.1:compile deploy

  Ã¶nce clean lifecycle'si, sonra plugin'in sadece ilgili goal'Ã¼, ve sonra deploy `phase`'ine gelene kadar ki tÃ¼m `phase`'ler Ã§aÄŸrÄ±lÄ±r.

Default olarak her `phase`'a baÄŸlÄ±(bounded) bazÄ± plugin'ler var. Fakat bu iliÅŸkiler(bound'lar), `pom.xml` dosyasÄ±ndaki packaging (jar, war gibi) deÄŸerine gÃ¶re deÄŸiÅŸiklik gÃ¶stermektedir. kaynak: http://maven.apache.org/ref/3.8.1/maven-core/default-bindings.html

## ğŸ“Œ Ã¶rnek goal tanÄ±mlama

1 `goal` birden fazla `phase` tarafÄ±ndan Ã§aÄŸrÄ±labilir.

`goal` tanÄ±mlamak iÃ§in plugin ÅŸart. her plugin'in `goal`'leri var. aÅŸaÄŸÄ±daki `XML` config'inde gÃ¶rÃ¼ldÃ¼ÄŸÃ¼ gibi bir plugin'in hangi `phase`'lerden Ã§alÄ±ÅŸacaÄŸÄ± ve hangi `goal`'lerin o `phase`'lerde olduÄŸu belirtilmektedir.

EÄŸer bir `goal` hiÃ§bir `phase`'e dahil edilmezse, o zaman sadece(ancak) o `goal`'i tek baÅŸÄ±na komut satÄ±rÄ±ndan tetikleyerek run edebiliriz.

```xml
<build>
  <plugins>
  <plugin>
    <groupId>org.apache.Maven.plugins</groupId>
    <artifactId>Maven-antrun-plugin</artifactId>
    <version>1.1</version>
    <executions>
      <execution>
        <id>id.validate</id>
        <phase>validate</phase>
        <goals>
            <goal>run</goal>
        </goals>
        <configuration>
          <tasks>
            <echo>in validate phase (the first phase of build lifecycle)</echo>
          </tasks>
        </configuration>
      </execution>
```

## ğŸ“Œ execution

`execution`, bir `goal`'in farklÄ± konfigÃ¼rasyonlarda Ã§alÄ±ÅŸmasÄ±nÄ± saÄŸlamak iÃ§in yaratÄ±lmÄ±ÅŸtÄ±r. her `execution`'Ä±n bir `ID`'si var. her `execution`'Ä±n bir config'i var. her `execution` farklÄ± `goal`'lere yada `phase`'lere atayabiliriz.

## ğŸ“Œ sÄ±k karÅŸÄ±laÅŸÄ±lan Maven komut satÄ±rÄ± hatalarÄ±

### ğŸ“ŒğŸ“Œ mvn build

`mvn build` komutu hata verir. Ã§Ã¼nkÃ¼ bÃ¶yle bir `phase` yada `goal` yoktur.

`Eclipse`'in `M2Eclipse` plugin'i `Maven` entegrasyonu saÄŸlamaktadÄ±r. bu plugin yÃ¼klÃ¼ iken, bir `Maven` projesine saÄŸ tÄ±klandÄ±ÄŸÄ±nda `Maven build` seÃ§eneÄŸi gÃ¶rÃ¼lecektir. bu seÃ§enek, daha Ã¶nce Ã§alÄ±ÅŸtÄ±rÄ±lmÄ±ÅŸ olan bir `Maven build` konfigÃ¼rasyonunu run edecektir. eÄŸer birden fazla config var ise, hangisini Ã§alÄ±ÅŸtÄ±rmak istediÄŸimizi soracaktÄ±r. yeni config yaratmak veya eskilerini dÃ¼zenlemek iÃ§in `Maven build ...` seÃ§eneÄŸine tÄ±klanmalÄ±dÄ±r.

### ğŸ“ŒğŸ“Œ "mvn clean install" vs "mvn install"

`mvn install` komutu, `clean` ayrÄ± bir `lifecycle` olduÄŸundan, `clean` `phase`'ini Ã§alÄ±ÅŸtÄ±rmaz ve bu sebeple `target` dizinini silmez. `clean` olmadÄ±ÄŸÄ± iÃ§in ve `install` Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±z iÃ§in ÅŸu hatayÄ± alabiliriz: eÄŸer bir plugin `build` sÄ±rasÄ±nda source code generate ediyor ise, `target`'ta zaten o source'lar var olduÄŸundan duplicate tarzÄ± bir hata alabiliriz.

yani; sÄ±rasÄ± ile:

```sh
mvn clean install

mvn install
```

Ã§alÄ±ÅŸtÄ±rÄ±rsak, plugin'lere baÄŸlÄ± olarak hata alma durumumuz olabilir.

aynÄ± sebepten:

```sh
mvn clean install

mvn deploy
```

komutu da hata verebilir.

## ğŸ“Œ target vs source JDK version

`target` sÃ¼rÃ¼mÃ¼ uygulamanÄ±n minimum hangi versiyon `JDK` Ã¼zerinde Ã§alÄ±ÅŸtÄ±rÄ±lacaÄŸÄ± anlamÄ±na geliyor. `target` `jar`/`war` dosyasÄ± o `JDK` sÃ¼rÃ¼mÃ¼ne uyumlu class'larÄ± Ã¼retiyor.

`source` ise; uygulamanÄ±n kodlarÄ±nÄ±n hangi versiyon ile derleneceÄŸini belirtiyor. uygulama yeni teknolojide Ã§alÄ±ÅŸabilir fakat kodlarÄ±n eski sÃ¼rÃ¼mler ile kontrol edilmesi istenebilir. bunun birkaÃ§ sebebi olabilir;

`1-` ilerideki zamanlarda projenin eski sÃ¼rÃ¼m `Java`'larda Ã§alÄ±ÅŸmasÄ± istenebilir. o zaman sadece target'Ä± dÃ¼ÅŸÃ¼rmek yeterli olacaktÄ±r.

`2-` kontrol amaÃ§lÄ±.

`3-` projenin `target` ve `source` versiyonu aynÄ± olduÄŸunu varsayalÄ±m. fakat spesifik olarak sadece benim sistemin iÃ§in derleme yapmak istiyorum. benim sistemim Ã§ok gÃ¼ncel. gÃ¼ncel bir `Java`'ya gÃ¶re derlenen daha hÄ±zlÄ± Ã§alÄ±ÅŸacaÄŸÄ±ndan, sadece `target` versiyonunu yÃ¼kseltip derleme yapabiliriz.

## ğŸ“Œ transitive dependency

`Transitive` kelime anlamÄ±: geÃ§iÅŸli

`Maven` `dependency`'leri 2 Ã§eÅŸittir:

- `Direct`: kendi projemizde `pom.xml` dosyamÄ±zda olan `dependency`'dir.

- `Transitive`: bizim `pom.xml` dosyamÄ±zda bulunan `dependency`'lerin `dependency`'leridir.

`Transitive` `dependency`'leri de sayarsak bir projede, aynÄ± `dependency`'nin farklÄ± sÃ¼rÃ¼mleri denk gelecektir. `Dependency tree` komutu ile bu listeyi gÃ¶rebiliriz. Fakat `target`'a atÄ±lacak olan `jar` `direct` `dependency`'ye en yakÄ±n olan olacaktÄ±r (tabi `optional` gibi parametresi olan `dependency`'ler ignore edilecektir). `kaynak: https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html title: 'transitive dependencies', sub-title: 'Dependency mediation'`

## ğŸ“Œ dependency

her `dependency`'de ayrÄ± ayrÄ± `scope` deÄŸeri belirtilebilir. `scope` aÅŸaÄŸÄ±daki deÄŸerler olabilir:

- `test`: bu kÃ¼tÃ¼phanenin sadece test paketlerini derlerken ve test `execution`'larÄ±nda (test runtime'Ä±nda) kullanÄ±lacaÄŸÄ± anlamÄ±na gelir.

- `provided`: kÃ¼tÃ¼phanenin sadece derleme aÅŸamasÄ±na olacaÄŸÄ± ve output (`target`) klasÃ¶rÃ¼ndeki `jar`/`war` dosyasÄ±na konmayacaÄŸÄ± anlamÄ±na gelir. Ã¶rnek `Weblogic` iÃ§erisinde olan bir kÃ¼tÃ¼phaneyi `scope=provided` yapmak gereklidir.

  `provided` `lib`'ler `compile` sÄ±rasÄ±nda kullanÄ±lÄ±r. bu sebeple `Lombok`'ta provided'tÄ±r.

- `runtime`: sadece `runtime` sÄ±rasÄ±nda bu `jar` `target`'ta bulunur. `compile time`'da bu `jar` kullanÄ±lmaz.

- `compile`: default `scope`'tur. hem `compile` hem de `target`'ta `jar`'Ä±n iÃ§inde bulunurlar.

- `system`: bu kÃ¼tÃ¼phanenin path'inin `Maven` repo'larÄ±nda olmayacaÄŸÄ± ve local dizinde olacaÄŸÄ± anlamÄ±na gelir. bu sebeple `jar`'Ä±n lokaldeki path'ini ek olarak yazmak gereklidir. Ã¶rneÄŸin `C:\Libs\abc.jar` gibi. canlÄ± ve development ortamÄ±nda aynÄ± dizin kullanÄ±lmaktadÄ±r. compile sÄ±rasÄ±nda bu `jar` kullanÄ±lÄ±r, aynÄ± zamanda bu dizin `manifest`'te `classpath`'e de eklenir. yani `jar`'Ä±n iÃ§ine atÄ±lmaz. Ã§Ã¼nkÃ¼ zaten her ortamda aynÄ± dizinde olmasÄ± beklenir. bu durumda; `scope`'u `provided`'a benzemiÅŸ olur. (`system` `scope`'u gÃ¼ncel `Maven` sÃ¼rÃ¼mlerinde deprecated oldu).

  `system` `scope`'u `test` yada `compile` time gibi bÃ¶lÃ¼nemez. sistemin tÃ¼m akÄ±ÅŸÄ±nda bu `jar` olacaktÄ±r.

- `import`: sadece `dependencyManagement` iÃ§erisinde kullanÄ±labilir. eÄŸer `dependencyManagement` ve `dependency`'mizin tipi `pom` ise, o zaman bunu koymak zorundayÄ±z. scope'u import yaptÄ±ÄŸÄ±mÄ±z ÅŸeyler `BOM` oluyor. `BOM`'un `pom`'unun iÃ§indeki tÃ¼m `dependency`'ler, bizim `dependencyManagement`'te ayrÄ± ayrÄ± tanÄ±mlanmÄ±ÅŸ gibi varsayÄ±lÄ±yor. Ã¶rnek:

```xml
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>X</groupId>
            <artifactId>Y</artifactId>
            <version>Z</version>
            <scope>import</scope>
            <type>pom</type>
        </dependency>

        <!-- Y iÃ§erisinde olan tÃ¼m dependency'ler bu satÄ±rda yazÄ±lmÄ±ÅŸ gibi varsayÄ±lÄ±yor. -->
    </dependencies>
</dependencyManagement>
```

## ğŸ“Œ transitive dependency scopes

`transitive` `dependency`'nin `scope`'u eÄŸer `compile` veya `runtime` ise, aynÄ± ÅŸekilde bizim `JAR`'Ä±mÄ±za da aynÄ± `scope` ile yansÄ±r. eÄŸer `transitive` `dependency` `test` veya `provided` ise o `JAR` tamamen ihmal edilir. `kaynak: https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html "Dependency Scope" baÅŸlÄ±ÄŸÄ±ndaki tablo`.

## ğŸ“Œ scope=import vs parent

`scope=import` sadece `dependency` sÃ¼rÃ¼mlerini tanÄ±mlamak iÃ§in kullanÄ±labilir. oysa `parent pom`'daki tÃ¼m `pom`, alt-projelere aynen inherit edilir.

## ğŸ“Œ dependency type

bazÄ± durumlarda `dependency`'nin dosya uzantÄ±sÄ± (`.jar`, `.war` gibi) bilinse de, aynÄ± uzantÄ±lÄ± dosyalarda farklÄ± amaÃ§lar sÃ¶z konusu olabilir.

Bu listede tÃ¼m `type`'lar listelenmiÅŸtir: http://maven.apache.org/ref/3.6.3/maven-core/artifact-handlers.html

Linkteki listeye bakÄ±ldÄ±ÄŸÄ±nda `.jar` uzantÄ±lÄ± olsa da, `type=Java-source` olarak set ettiÄŸimizde, o `jar` `classpath`'e eklenmiyor. Oysa `type=jar` deseydik, o `jar` `classpath`'e eklenecekti.

## ğŸ“Œ classifier

her `Maven` projesinin birden fazla `classifier` tanÄ±mÄ± olabilir. Ã¶rneÄŸin; `abc` projemiz de 1 `classifier`'siz bir de source `classifier`'li `jar`'Ä± olabilir. hangi `classifier`'lerin olacaÄŸÄ± `abc` projesinin `pom.xml` dosyasÄ±nda tanÄ±mlanmalÄ±dÄ±r. Bu durumda ÅŸu `jar`'lar `target`'ta oluÅŸur:

- `abc-$version.jar`
- `abc-$version-$classifier.jar` (Ã¶rnek: `abc-2-source.jar`)

`abc-2-source.jar`'Ä±mÄ±z source sÄ±nÄ±flarÄ±nÄ± da barÄ±ndÄ±rÄ±r. bÃ¶ylece `abc`'yi kullanan projeler `debug` sÄ±rasÄ±nda, kodumuzu kolay `debug` edebilir. Buna benzer birÃ§ok farklÄ± amaÃ§ iÃ§in `classifier` oluÅŸturabiliriz. En sÄ±k kullanÄ±lan baÅŸka bir Ã¶rnek ise `javadoc` `classifier`'Ä±dÄ±r. `DOC`'larÄ± da attach edip jar iÃ§ine koyabiliriz. BÃ¶ylece `abc`'yi `dependency` olarak kullanan projelerde, `IDE` metot isimlerinin aÃ§Ä±klamalarÄ±nÄ±, developer'a otomatik gÃ¶sterir.

`Classifier` string'i tamamen custom'dÄ±r. istediÄŸimiz herhangi bir string deÄŸerini verebiliriz.

Custom bir Ã¶rnek Ã¼zerinden gidelim: Sunucumuz olsun. Bu sunucumuzun model, client ve sunucu parÃ§alarÄ± var. Hepsi iÃ§in ayrÄ± repo veya modÃ¼l aÃ§mak yerine, hepsini ayrÄ± `classifier`'lerle daÄŸÄ±tabiliriz. Bunun iÃ§in sunucu'nun `pom`'unda aÅŸaÄŸÄ±dakiler olmalÄ±dÄ±r:

`server` projesinin `pom.xml` dosyasÄ±:

```xml
<build>
  <plugins>
    <plugin>
      <groupId>org.apache.Maven.plugins</groupId>
      <artifactId>Maven-jar-plugin</artifactId>
      <version>3.1.0</version>
      <executions>
        <execution>
          <id>package-client</id>
          <phase>package</phase>
          <goals>
            <goal>jar</goal>
          </goals>
          <configuration>
            <classifier>client</classifier>
            <includes>
             <include>**/com/app1/client/**</include>
            </includes>
          </configuration>
        </execution>
        <execution>
          <id>package-model</id>
          <phase>package</phase>
          <goals>
            <goal>jar</goal>
          </goals>
          <configuration>
            <classifier>model</classifier>
            <includes>
              <include>**/com/app1/model/**</include>
            </includes>
          </configuration>
        </execution>
      </executions>
    </plugin>
  </plugins>
</build>
```

ArtÄ±k bizim projeyi `client` ile Ã§aÄŸÄ±racak olan developer kendi projesinde bunlarÄ± `dependency`'ye eklemelidir:

```xml
<dependencies>
  <dependency>
    <groupId>com.app1</groupId>
    <artifactId>server</artifactId>
    <version>1.0-SNAPSHOT</version>
    <classifier>model</classifier>
  </dependency>
  <dependency>
    <groupId>com.app1</groupId>
    <artifactId>server</artifactId>
    <version>1.0-SNAPSHOT</version>
    <classifier>client</classifier>
  </dependency>
</dependencies>
```

Ä°stersek model ve client'Ä± birleÅŸtirebiliriz, Ã§Ã¼nkÃ¼ ayrÄ± ayrÄ± yazÄ±lmasÄ±na gerek olmamalÄ±.

## ğŸ“Œ profiles

profiller ile; derleme sÄ±rasÄ±nda, belirtilen dinamik dizin (aÅŸaÄŸÄ±daki Ã¶rnekte directory), `Java`'daki `resource` klasÃ¶rÃ¼nÃ¼n root'una kopyalanÄ±r.

```xml
<profiles>
  <profile>
   <id>test</id>
   <activation>
        <activeByDefault>true</activeByDefault>
   </activation>
   <build>
   <resources>
        <resource>
            <directory>src/main/resources/profiles/test</directory>
        </resource>
   </resources>
   </build>
  </profile>
```

profiller ile aynÄ± zamanda her profilin farklÄ± repo'su, eklentisi, `dependency` gibi seÃ§enekleri olmasÄ± da ayarlanabilmektedir.

## ğŸ“Œ plugin-management vs plugin

`plugin-management` iÃ§erisinde plugin'ler, projenin alt modÃ¼lÃ¼ndeki yada ilgili proje iÃ§in sadece bir tanÄ±mdÄ±r. bunlarÄ±n kullanÄ±p kullanÄ±lmayacaÄŸÄ±na her projenin `pom`'u kendi karar verir. kullanÄ±lmak istenen eklenti `build-plugins` iÃ§erisinde belirtilmesi yeterlidir. eÄŸer override edilmesi gereken parametreler var ise onlar mutlaka geÃ§ilmelidir.

parent projede:

```xml
 <build>
   ...
   <pluginManagement>
     <plugins>
       <plugin>
         <groupId>org.apache.Maven.plugins</groupId>
         <artifactId>Maven-jar-plugin</artifactId>
         <version>2.6</version>
         <executions>
             <execution>
```

alt projede:

```xml
 <build>
   ...
   <pluginManagement>
     <plugins>
       <plugin>
         <groupId>org.apache.Maven.plugins</groupId>
         <artifactId>Maven-jar-plugin</artifactId>
         <!-- versiyon dahi belirtmeye gerek yok. isteÄŸe baÄŸlÄ± burada config'ler override edilebilir. -->
        </plugin>
```

## ğŸ“Œ dependency-management

`plugin-management`'e benzer yapÄ±da `dependency`'leri yÃ¶netebilmek iÃ§inde bir kullanÄ±m mevcuttur. Ã¶rneÄŸin `Spring` framework'Ã¼ her sÃ¼rÃ¼mÃ¼ iÃ§in ayrÄ± ayrÄ± `dependency-management` iÃ§erisinde tÃ¼m `Spring` kÃ¼tÃ¼phanelerini iÃ§eren `pom`'lar yaratmÄ±ÅŸtÄ±r. istediÄŸimiz bir versiyon'u `dependency-management`'a ekleyerek sadece kullanacaÄŸÄ±mÄ±z kÃ¼tÃ¼phaneleri `dependency` kÄ±smÄ±na eklememiz yeterlidir. hiÃ§bir `dependency` iÃ§in sÃ¼rÃ¼m belirtmek zorunda kalmayÄ±z.

## ğŸ“Œ Maven wrapper

`pom.xml` `IDE` tarafÄ±ndan okunur ve ilgili iÅŸlemlerin koÅŸmasÄ± saÄŸlanÄ±r. fakat `Maven`, `IDE`'siz de Ã§alÄ±ÅŸtÄ±rÄ±labilir. `Maven` default command-line uygulamasÄ± mevcut. Bu `IDE`'lerin iÃ§ine de gÃ¶mÃ¼lebilir, `OS`'a de kurulabilir. `Maven` `wrapper` basit bir `script`'tir. bu `script` projenin root'unda `pom.xml` dosyasÄ±nÄ±n yanÄ±nda bulunur. bu `script` `OS`'un komut satÄ±rÄ±nda Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda `Maven`'Ä± `OS` path'inde arar, yoksa download eder ve `Maven` komutlarÄ±nÄ± Ã§alÄ±ÅŸtÄ±rmamÄ±zÄ± saÄŸlar. portabilite kazandÄ±rÄ±r. `IDE` den baÄŸÄ±msÄ±zlÄ±ÄŸÄ± getirir. `pom.xml` dosyasÄ±na uygun `Maven` sÃ¼rÃ¼mÃ¼nÃ¼ bulmaya Ã§alÄ±ÅŸÄ±r. her `OS` iÃ§in farklÄ± `script` dosyasÄ± olmalÄ±dÄ±r, Ã§Ã¼nkÃ¼ her `OS`'un kendi `script` dili vardÄ±r.

piyasada bir Ã§ok `Maven` `wrapper` dosyasÄ± oluÅŸturan yazÄ±lÄ±mlar vardÄ±r.

`Maven` `wrapper`'larÄ±n `Maven` eklentileri de olabiliyor. bu `Maven` eklentileri ile lifecycle iÃ§erisinde `Maven` `wrapper` `script` dosyalarÄ±nÄ± oluÅŸturulmasÄ± saÄŸlanÄ±yor.

`Maven` `wrapper`, `Maven` standartlarÄ±nda belirtilmiÅŸ bir ÅŸey deÄŸildir.

## ğŸ“Œ Archetype

TÃ¼rkÃ§e kelime anlamÄ±: prototip

`mvn` komutu ile yeni proje oluÅŸturduÄŸumuzda, oluÅŸan dosyalarÄ±n ve dizinlerin ve `pom.xml` dosyalarÄ±nda neler yazacaÄŸÄ± gibi bilgilerin olduÄŸu template'e verilen isimdir. kullanÄ±lan `Archetype`'Ä±n tanÄ±mÄ±na gÃ¶re, generate ettiÄŸimiz projede alt-modÃ¼ller de olabilir.

piyasada birÃ§ok `Archetype` mevcuttur. kendi `Archetype`'Ä±mÄ±zÄ± da yapabilir. sadece basit `Java` projesi iÃ§in bile birÃ§ok farklÄ± kaynaktan `Archetype` bulabiliriz.

`Archetype` bilgisi (hangi `Archetype`'Ä± seÃ§tiÄŸimiz) `effective pom.xml` dosyasÄ±nda dahi yazmaz. Ã§Ã¼nkÃ¼ `Archetype`, sadece `pom.xml` dosyasÄ±nÄ± ve dizinleri (`/src`, `/test` gibi) oluÅŸturur. `super pom` dosyasÄ±nÄ± deÄŸiÅŸtiremez. eÄŸer `super pom` dosyasÄ±nda deÄŸiÅŸtirmesi ÅŸart olan bir deÄŸer var ise, zaten generate ettiÄŸi `pom`'da istediÄŸi deÄŸerleri override edebilir.

## ğŸ“Œ SNAPSHOT

`SNAPSHOT` is a special keyword known by repository servers (like `Nexus`) and `Maven` command.

`SNAPSHOT` keyword should always set as suffix only.

`SNAPSHOT` basically means that this version is still under development. So it can be updated anytime. so as a best practice:

- you can update a `snapshot` version by pushing `jar` file to remote repository (like `Nexus`).
- you can not update a non-`SNAPSHOT` version by pushing `jar` (repository should not allow you).

But both above behaviors can be changed by remote repository configurations. `Maven` command has built-in push plugin but it does not care about this behavior (the above rules).

Now let's take a look how `Maven` command manages local `Maven` repository (`$HOME/.m2` directory). `Maven` as default does not re-check the local `jar` files (`dependencies`) on every `install` command if they are updated on remote repository. The only way to enable re-check `jar` from remote are:

- pass `-U` (update snapshots) parameter to `mvn install` command. It will check the hash of remote `jar` and local (`.m2`) `jar` file. If it is different, then it downloads the `jar` from remote to local. `Update snapshot` only works for the `SNAPSHOT` suffixed `jars`.

- setup the configs on `pom.xml` as example:

```xml
  <repositories>
    <repository>
      <releases>
        <enabled>false</enabled>
        <updatePolicy>always</updatePolicy>
        <checksumPolicy>warn</checksumPolicy>
      </releases>
      <snapshots>
        <enabled>true</enabled>
        <updatePolicy>never</updatePolicy>
        <checksumPolicy>fail</checksumPolicy>
      </snapshots>
      <name>Nexus Snapshots</name>
      <id>snapshots-repo</id>
      <URL>https://oss.sonatype.org/content/repositories/snapshots</url>
      <layout>default</layout>
    </repository>
  </repositories>
</project>
```

some options for above example (on `pom.xml`):

- `layout`: `default` or `legacy` (for `Maven` `1.x` support)

- `enabled`: enables or disables this repository/config

- `updatePolicy`:
  - `always`
  - `daily` (default)
  - `interval:X` (where `X` is an integer in minutes)
  - `never` - This only works on `mvn install` command and only checks time-stamp of `jar` files on `.m2` directory.

- `checksumPolicy`:
  - `ignore`
  - `fail`
  - `warn`
  
  checks whatever hash of `jar` file is same or not.

## ğŸ“Œ revision

```xml
<project>
   <groupId>group1</groupId>
   <artifactId>artifact1</artifactId>
   <version>${revision}</version>
</project>
```

`revision` Ã¶zel bir keyword. ArtÄ±k bu ÅŸekilde sÃ¼rÃ¼m derlemesi yapabiliriz:

```sh
mvn -Drevision="1.0.0-SNAPSHOT" clean package
```

EÄŸer ilgili `pom.xml` dosyamÄ±za bunu eklersek:

```xml
<properties>
   <revision>1.0.0-SNAPSHOT</revision>
</properties>
```

default deÄŸer gibi varsayÄ±lÄ±r. `-Drevision` yollamazsak `properties`'de yazan deÄŸer kullanÄ±lÄ±r.

## ğŸ“Œ Maven plugins

A `Maven` plugin is a group of `goal`s.

bazÄ± plugin'ler `build`, bazÄ±larÄ± ise `reporting` `XML` `tag`'i iÃ§ine alÄ±nÄ±yor (neden bu ÅŸekilde bir mimari uygulanmÄ±ÅŸ bulanamadÄ±m). Bu durum ile ilgili kurallar burada belirtilmiÅŸtir: https://maven.apache.org/guides/mini/guide-configuring-plugins.html#Using_the_reporting_Tag_VS_build_Tag

Ã–zetle:

- `clean` ve `default` `lifecycle`'sinde olan plugin'ler mutlaka `build` `XML` `tag`'i iÃ§ine alÄ±nmalÄ±dÄ±r. `site` `lifecycle`'Ä±ndaki plugin'ler ise `reporting` ve `build` iÃ§erisine alÄ±nabilir.
- `build` iÃ§erisine alÄ±nan `site` plugin'lerinin konfigÃ¼rasyonlarÄ± ignore edilir.
- eÄŸer manuel `P` plugin'in `G` `goal`'ini Ã§aÄŸÄ±rÄ±rsak; Ã¶nce `reporting` `tag`'indeki konfigÃ¼rasyonlarÄ± okur, eÄŸer yok ise `build` iÃ§erisine alÄ±nan `P` plugin'in konfigÃ¼rasyonlarÄ±nÄ± okur.

AÅŸaÄŸÄ±da `Maven` projesi tarafÄ±ndan desteklenen resmi plugin'lerin listesi verilmiÅŸtir.

| Plugin                      | Description                                                                                                            |
|-----------------------------|------------------------------------------------------------------------------------------------------------------------|
| __Core plugins__          | __Plugins corresponding to default core phases (ie. clean, compile). They may have multiple goals as well.__          |
| clean                       | Clean up after the build.                                                                                              |
| compiler                    | Compiles Java sources.                                                                                                 |
| deploy                      | Deploy the built artifact to the remote repository.                                                                    |
| failsafe                    | Run the JUnit integration tests in an isolated `class loader`.                                                            |
| install                     | Install the built artifact into the local repository.                                                                  |
| resources                   | Copy the resources to the output directory for including in the JAR.                                                   |
| site                        | Generate a site for the current project.                                                                               |
| surefire                    | Run the JUnit unit tests in an isolated `class loader`.                                                                   |
| verifier                    | Useful for integration tests - verifies the existence of certain conditions.                                           |
| __Packaging types/tools__ | __These plugins relate to packaging respective artifact types.__                                                     |
| ear                         | Generate an EAR from the current project.                                                                              |
| EJB                         | Build an EJB (and optional client) from the current project.                                                           |
| jar                         | Build a JAR from the current project.                                                                                  |
| rar                         | Build a RAR from the current project.                                                                                  |
| war                         | Build a WAR from the current project.                                                                                  |
| app-client/acr              | Build a Java EE application client from the current project.                                                            |
| shade                       | Build an Uber-JAR from the current project, including dependencies.                                                    |
| source                      | Build a source-JAR from the current project.                                                                           |
| jlink                       | Build Java RunTime Image.                                                                                             |
| jmod                        | Build Java JMod files.                                                                                                 |
| __Reporting plugins__      | __Plugins which generate reports, are configured as reports in the POM and run under the site generation lifecycle.__ |
| changelog                   | Generate a list of recent changes from your SCM.                                                                       |
| changes                     | Generate a report from an issue tracker or a change document.                                                          |
| checkstyle                  | Generate a Checkstyle report.                                                                                          |
| doap                        | Generate a Description of a Project (DOAP) file from a POM.                                                            |
| docck                       | Documentation checker plugin.                                                                                          |
| javadoc                     | Generate Javadoc for the project.                                                                                      |
| jdeps                       | Run JDK's JDeps tool on the project.                                                                                   |
| jxr                         | Generate a source cross reference.                                                                                     |
| linkcheck                   | Generate a Linkcheck report of your project's documentation.                                                           |
| pmd                         | Generate a PMD report.                                                                                                 |
| project-info-reports        | Generate standard project reports.                                                                                     |
| surefire-report             | Generate a report based on the results of unit tests.                                                                  |
| __Tools__                 | __These are miscellaneous tools available through Maven by default.__                                                |
| antrun                      | Run a set of ant tasks from a phase of the build.                                                                      |
| archetype                   | Generate a skeleton project structure from an archetype.                                                               |
| assembly                    | Build an assembly (distribution) of sources and/or binaries.                                                           |
| dependency                  | Dependency manipulation (copy, unpack) and analysis.                                                                   |
| enforcer                    | Environmental constraint checking (Maven Version, JDK etc), User Custom Rule Execution.                                |
| gpg                         | Create signatures for the artifacts and poms.                                                                          |
| help                        | Get information about the working environment for the project.                                                         |
| invoker                     | Run a set of Maven projects and verify the output.                                                                     |
| jarsigner                   | Signs or verifies project artifacts.                                                                                   |
| jdeprscan                   | Run JDK's JDeprScan tool on the project.                                                                               |
| patch                       | Use the gnu patch tool to apply patch files to source code.                                                            |
| PDF                         | Generate a PDF version of your project's documentation.                                                                |
| plugin                      | Create a Maven plugin descriptor for any Mojos found in the source tree, to include in the JAR.                        |
| release                     | Release the current project - updating the POM and tagging in the SCM.                                                 |
| remote-resources            | Copy remote resources to the output directory for inclusion in the artifact.                                           |
| scm                         | Execute SCM commands for the current project.                                                                          |
| scm-publish                 | Publish your Maven website to a scm location.                                                                          |
| stage                       | Assists with release staging and promotion.                                                                            |
| toolchains                  | Allows to share configuration across plugins.                                                                          |

## ğŸ“Œ MojoHaus (âŸ· old-name:Mojo@Codehaus.org)

`Maven` eklentileri geliÅŸtiren projedir.

## ğŸ“Œ Mojo (âŸ· Maven plain Old Java Object)

`MojoHaus` ismi buradan tÃ¼remiÅŸtir. Each `Mojo` is an executable `goal` in `Maven`, and a plugin is a distribution of one or more related `Mojo`s. `Maven` plugin developer'larÄ±nÄ±n bildiÄŸi bir terimdir. `Maven` kullanan developer'larÄ±n bildiÄŸi bir terim deÄŸildir.

## ğŸ“Œ Maven-deploy-plugin vs nexus-staging-Maven-plugin

`Maven-deploy-plugin` `nexus` sunucusuna deploy yapabiliyor. fakat `Nexus-staging-maven-plugin`, sadece `nexus` sunucusuna Ã¶zgÃ¼ ek Ã¶zellikler de barÄ±ndÄ±rÄ±yor (Ã¶rnek: `staging` Ã¶zelliÄŸi). opsiyonel olarak tercih edilebilir.

## ğŸ“Œ Findbugs vs Checkstyle

`Findbugs` `Bytecode` bazÄ±nda projeyi inceleler ve hatalarÄ± bulur. oysa `Checkstyle` sadece source code'u check eder. ikisini de kullanmak gerekli. Ã§Ã¼nkÃ¼ mimarileri gereÄŸi birbirlerinin yakalamadÄ±klarÄ± sorunlar var.

## ğŸ“Œ sÄ±k kullanÄ±lan bazÄ± plugin'ler

- `Spring-boot-Maven-plugin`

  - `Actuator` tarafÄ±ndan kullanÄ±lmak Ã¼zere `JAR` iÃ§erisine `build-info` bilgisi generate edebiliyor.
  - `Maven` komutlarÄ± ile projeyi run edebilmemizi saÄŸlÄ±yor.
  - `jar`'Ä±n iÃ§indeki `manifest` dosyasÄ±na `Main` class'Ä± tanÄ±mlayabilmemizi saÄŸlÄ±yor. bÃ¶ylece `jar`'Ä± run ederken, `main` class'Ä±mÄ±zÄ± parametre gerÃ§ek zorunda kalmÄ±yoruz.

- `Maven-source-plugin`

  source code'un Ã¶zel (normal artifact'tan ayrÄ±) bir `jar` oluÅŸturup onun iÃ§ine atÄ±yor. genelde open source projeler veya ÅŸirket iÃ§inde internal geliÅŸtirmelerde buna ihtiyaÃ§ oluyor. bu ÅŸekilde uygulamamÄ±zÄ± `jar` olarak `dependency` ekleyen projeler, projemizin kodlarÄ±nÄ± debug edebiliyor. fakat bu source `JAR`'larÄ±nda repository server'Ä±na push'lanmasÄ± gerekmektedir.

- `build-helper-Maven-plugin`

  `build` aÅŸamasÄ± iÃ§in ekstra Ã¶zellikler iÃ§eriyor (bazÄ±larÄ± `Maven-compiler-plugin` ile de yapÄ±labiliyor). Ã¶rnek:

  - `build` aÅŸamasÄ±nda bazÄ± directory'leri source kod olarak set edebilmemizi saÄŸlÄ±yor (Ã¶rnek `src/extra/java`'nÄ±n da kod dizini olarak tanÄ±mlanmasÄ±nÄ± saÄŸlÄ±yor)

## ğŸ“Œ pom'dan bilgi okuma

`help` plugin'i `pom`'dan bu ÅŸekilde bilgi okuyabilmemizi saÄŸlÄ±yor:

```sh
./mvnw help:evaluate -Dexpression=project.version -q -DforceStdout
```

## ğŸ“Œ -DskipTests vs -Dmaven.test.skip=true

`-DskipTests` test kodlarÄ±nÄ± compile eder fakat testleri koÅŸmaz.

`-Dmaven.test.skip=true` hem test kodlarÄ±nÄ± derlemiyor hem de testleri koÅŸmuyor.

## ğŸ“Œ paralel test

`Maven-surefire-plugin`'in paralel test koÅŸmak iÃ§in seÃ§enekleri vardÄ±r. bu seÃ§eneklerin bazÄ±larÄ±:

- `forkCount`

  - parametre olarak sayÄ± alÄ±r.

  - default deÄŸeri 1'dir.

  - en fazla kaÃ§ adet `JVM` aÃ§Ä±lacaÄŸÄ±nÄ± belirtir.

- `reuseFork`

  - parametre olarak boolean alÄ±r.

  - true is by default.

  - `forkCount`'ta belirtilen sayÄ±da `JVM`'in tekrar mÄ± aÃ§Ä±lacaÄŸÄ±nÄ± yoksa, yeni bir test koÅŸulduÄŸunda aynÄ± `JVM`'in mi tetikleneceÄŸi belirtilmektedir.

  - aynÄ± `JVM`'in kullanÄ±lmasÄ± `@BeforeClass` gibi kodlarÄ±n ortak Ã§alÄ±ÅŸmasÄ±nÄ± saÄŸlar.

- `parallel`

  - aynÄ± `JVM` iÃ§erisinde hangi testlerin paralel koÅŸulacaÄŸÄ±nÄ± belirlemek iÃ§in kullanÄ±lÄ±r.

  - alacaÄŸÄ± argÃ¼man test provider'Ä±na gÃ¶re deÄŸiÅŸir. Ã¶rneÄŸin `JUnit` `4.7`'de ÅŸunlarÄ± alabilir: `methods`, `classes`, `both`, `suites`, `suitesAndClasses`, `suitesAndMethods`, `classesAndMethods`, `all`.

## ğŸ“Œ BOM

`Bill Of Materials`'in kÄ±saltmasÄ±dÄ±r. `BOM`'lar sadece `dependency` yÃ¶netimini saÄŸlamak iÃ§in oluÅŸturulmuÅŸ projelerdir. 2 ÅŸekilde `BOM`'larÄ± projemize import edebiliriz:

- `dependency management`'e import ederek:

```xml
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>myapp</groupId>
            <artifactId>myapp-BOM</artifactId>
            <version>0.0.1-SNAPSHOT</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>
```

- parent vererek:

```xml
<parent>
    <groupId>myapp</groupId>
    <artifactId>myapp-BOM</artifactId>
    <version>0.0.1-SNAPSHOT</version>
</parent>
```

## ğŸ“Œ BOM vs parent

`BOM` sadece `dependency`'lerin sÃ¼rÃ¼mlerini almamÄ±zÄ± saÄŸlar. Oysa parent project, `BOM`'un gÃ¶revini de saÄŸlar ve ek olarak isterse direk projemize plugin veya `dependency` ekler.
